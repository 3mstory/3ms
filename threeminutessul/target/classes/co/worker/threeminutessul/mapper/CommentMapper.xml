<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0/EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
mapper : MyBatis에서 사용하는 모든 SQL 을 작성하는 파일
-->
<mapper namespace="comment">
	<select id="commentList" parameterType="Integer" resultType="commentVo">
		select
			C.commentSeq
			, U.userSeq
			, U.nickname
			, C.boardSeq
			, C.content
			, case 
				when to_char(regdate,'YYYY-MM-DD hh24:mi:ss') = to_char(regdate,'YYYY-MM-DD hh24:mi:ss') then regdate 
				else updatedate 
			end as regdate
			,C.isanony
		from tblComment C
			inner join tblUserInfo U on U.userSeq = C.userSeq
		where boardSeq = #{boardSeq}
		  and parSeq = 0
	</select>
	<insert id="commentInsert" parameterType="commentVO">
		insert into 
			tblComment(userSeq, boardSeq, parSeq, content, regdate, updatedate, isanony) 
			values(#{userSeq}, #{boardSeq}, #{parSeq}, #{content}, now(), now(), 0)
	</insert>
</mapper>